<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Product Details - Lavela Decore</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="./assets/images/logo/lavellalogo.png" />

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/vendor/vendor.min.css" />
    <link rel="stylesheet" href="assets/css/plugins/plugins.min.css" />
    <link rel="stylesheet" href="assets/css/style.min.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    />

    <style>
      @font-face {
        font-family: "gebuk";
        src: url("assets/fonts/gebuk-font/gebuk-regular.otf") format("opentype");
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: "gebuk" !important;
      }

      .btn,
      button {
        background: #c2a674 !important;
        border-color: #c2a674 !important;
        color: #000 !important;
        padding: 15px 30px !important;
        border-radius: 0 !important;
        font-size: 14px !important;
        font-weight: 500 !important;
        letter-spacing: 0.5px !important;
        transition: all 0.3s ease !important;
        cursor: pointer !important;
      }

      .btn:hover,
      button:hover {
        background: #000 !important;
        border-color: #000 !important;
        color: #c2a674 !important;
        transform: translateY(-1px) !important;
      }

      .product-details-wrapper {
        padding: 60px 0;
        background: #f8f8f8;
      }

      .product-images {
        background: white;
        padding: 20px;
        border-radius: 10px;
      }

      .main-image {
        width: 100%;
        height: 500px;
        object-fit: cover;
        border-radius: 10px;
        margin-bottom: 20px;
      }

      .thumbnail-images {
        display: flex;
        gap: 10px;
        overflow-x: auto;
      }

      .thumbnail-images img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 5px;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.3s;
      }

      .thumbnail-images img:hover,
      .thumbnail-images img.active {
        border-color: #c2a674;
      }

      .product-info {
        background: white;
        padding: 30px;
        border-radius: 10px;
      }

      .product-category {
        color: #666;
        font-size: 14px;
        text-transform: uppercase;
        margin-bottom: 10px;
      }

      .product-title {
        font-size: 2.5rem;
        margin-bottom: 20px;
        color: #000;
      }

      .product-price {
        font-size: 2rem;
        color: #c2a674;
        margin-bottom: 20px;
      }

      .product-price .original-price {
        text-decoration: line-through;
        color: #999;
        font-size: 1.5rem;
        margin-left: 15px;
      }

      .product-description {
        color: #666;
        line-height: 1.8;
        margin-bottom: 30px;
      }

      .product-options {
        margin-bottom: 30px;
      }

      .color-options {
        display: flex;
        gap: 10px;
        margin-top: 10px;
      }

      .color-option {
        padding: 8px 16px;
        border: 2px solid #ddd;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .color-option:hover,
      .color-option.selected {
        border-color: #c2a674;
        background: #f5f5f5;
      }

      .quantity-selector {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 30px;
      }

      .quantity-input {
        display: flex;
        align-items: center;
        border: 2px solid #ddd;
        border-radius: 5px;
      }

      .quantity-input button {
        background: transparent !important;
        border: none !important;
        color: #000 !important;
        padding: 10px 15px !important;
        font-size: 18px !important;
      }

      .quantity-input input {
        width: 50px;
        text-align: center;
        border: none;
        font-size: 16px;
      }

      .action-buttons {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
      }

      .action-buttons button {
        flex: 1;
      }

      .btn-wishlist {
        background: transparent !important;
        border: 2px solid #c2a674 !important;
        color: #c2a674 !important;
      }

      .btn-wishlist:hover {
        background: #c2a674 !important;
        color: #000 !important;
      }

      .btn-wishlist.active {
        background: #c2a674 !important;
        color: #000 !important;
      }

      .product-tabs {
        margin-top: 60px;
      }

      .nav-tabs {
        border-bottom: 2px solid #ddd;
      }

      .nav-tabs .nav-link {
        color: #666;
        border: none;
        padding: 15px 30px;
        font-size: 16px;
        transition: all 0.3s;
      }

      .nav-tabs .nav-link.active {
        color: #c2a674;
        border-bottom: 3px solid #c2a674;
        background: transparent;
      }

      .tab-content {
        padding: 30px 0;
      }

      .faq-item {
        margin-bottom: 20px;
        padding: 20px;
        background: #f8f8f8;
        border-radius: 5px;
      }

      .faq-question {
        font-weight: 600;
        margin-bottom: 10px;
        color: #000;
      }

      .faq-answer {
        color: #666;
        line-height: 1.6;
      }

      .toast {
        position: fixed;
        top: 100px;
        right: 20px;
        background: #000;
        color: #c2a674;
        padding: 15px 25px;
        border-radius: 5px;
        z-index: 9999;
        display: none;
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }

      @media (max-width: 768px) {
        .product-title {
          font-size: 1.8rem;
        }

        .product-price {
          font-size: 1.5rem;
        }

        .action-buttons {
          flex-direction: column;
        }

        .main-image {
          height: 300px;
        }
      }

      .material-list {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }

      .material-tag {
        background: #f0f0f0;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 14px;
      }

      .header-left-search {
        display: none !important;
      }
    </style>
  </head>

  <body>
    <!-- Header -->
    <div class="header-area header-area--default">
      <div class="header-top-bar">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-lg-4 col-md-4 d-none d-md-block">
              <div class="logo-wrapper">
                <div
                  class="logo-container"
                  style="
                    width: 80px;
                    height: 80px;
                    background: black;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                  "
                >
                  <a href="index.html">
                    <img
                      src="./assets/images/logo/lavellalogo.png"
                      alt="Logo"
                      style="
                        width: 70px;
                        height: 70px;
                        object-fit: contain;
                        border-radius: 50%;
                      "
                    />
                  </a>
                </div>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 col-6"></div>
            <div class="col-lg-4 col-md-4 col-6">
              <div class="header-right-side text-end">
                <div class="header-right-items">
                  <a href="wishlist.html" class="header-cart">
                    <i class="icon-heart"></i>
                    <span class="item-counter" id="wishlistCount">0</span>
                  </a>
                </div>
                <div class="header-right-items">
                  <a href="cart.html" class="header-cart">
                    <i class="icon-bag2"></i>
                    <span class="item-counter" id="cartCount">0</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Product Details -->
    <div class="product-details-wrapper">
      <div class="container">
        <div class="row">
          <!-- Product Images -->
          <div class="col-lg-6">
            <div class="product-images">
              <img
                id="mainImage"
                class="main-image"
                src="assets/images/placeholder.jpg"
                alt="Product"
              />
              <div class="thumbnail-images" id="thumbnailImages"></div>
            </div>
          </div>

          <!-- Product Info -->
          <div class="col-lg-6">
            <div class="product-info">
              <div class="product-category" id="productCategory">
                Loading...
              </div>
              <h1 class="product-title" id="productTitle">
                Loading product...
              </h1>
              <div class="product-price" id="productPrice">
                <span class="current-price">₹0</span>
              </div>
              <div class="product-description" id="productDescription">
                Loading description...
              </div>

              <!-- Materials -->
              <div
                class="product-options"
                id="materialsSection"
                style="display: none"
              >
                <h5>Materials Used</h5>
                <div class="material-list" id="materialsList"></div>
              </div>

              <!-- Color Options -->
              <div
                class="product-options"
                id="colorSection"
                style="display: none"
              >
                <h5>Color & Texture Options</h5>
                <div class="color-options" id="colorOptions"></div>
              </div>

              <!-- Quantity -->
              <div class="quantity-selector">
                <label>Quantity:</label>
                <div class="quantity-input">
                  <button onclick="decreaseQuantity()">-</button>
                  <input
                    type="number"
                    id="quantity"
                    value="1"
                    min="1"
                    max="10"
                    readonly
                  />
                  <button onclick="increaseQuantity()">+</button>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="action-buttons">
                <button class="btn btn-primary" onclick="addToCart()">
                  <i class="icon-bag2"></i> Add to Cart
                </button>
                <button
                  class="btn btn-wishlist"
                  id="wishlistBtn"
                  onclick="toggleWishlist()"
                >
                  <i class="icon-heart"></i>
                  <span id="wishlistText">Add to Wishlist</span>
                </button>
              </div>

              <div class="action-buttons">
                <button
                  class="btn btn-primary"
                  onclick="sendEnquiry()"
                  style="width: 100%"
                >
                  <i class="icon-phone"></i> Send Enquiry
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Product Tabs -->
        <div class="product-tabs">
          <ul class="nav nav-tabs">
            <li class="nav-item">
              <a
                class="nav-link active"
                data-bs-toggle="tab"
                href="#description"
                >Description</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" data-bs-toggle="tab" href="#howToUse"
                >How to Use</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" data-bs-toggle="tab" href="#faqs">FAQs</a>
            </li>
          </ul>

          <div class="tab-content">
            <div class="tab-pane fade show active" id="description">
              <p id="fullDescription">Loading full description...</p>
            </div>
            <div class="tab-pane fade" id="howToUse">
              <div id="howToUseContent">No information available</div>
            </div>
            <div class="tab-pane fade" id="faqs">
              <div id="faqsContent">No FAQs available</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div
      class="footer-area-wrapper"
      style="background-color: #1d1d1f; color: #c3a674"
    >
      <div class="footer-area section-space--ptb_120">
        <div class="container">
          <div class="row footer-widget-wrapper">
            <div class="col-lg-4 col-md-4 col-sm-6 footer-widget">
              <h6 class="footer-widget__title mb-20" style="color: #c3a674">
                Address
              </h6>
              <ul class="footer-widget__list">
                <li>Lavela Decore, Ravet Pune</li>
                <li>Phone: +91 88889 90137</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JS -->
    <script src="assets/js/vendor/jquery-3.5.1.min.js"></script>
    <script src="assets/js/vendor/bootstrap.min.js"></script>

    <script>
      const API_URL = "https://lavella.onrender.com/api";
      let currentProduct = null;
      let selectedColor = null;

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        loadProductDetails();
        updateCartCount();
        updateWishlistCount();
      });

      async function loadProductDetails() {
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get("id");

        if (!productId) {
          window.location.href = "shop-3-column.html";
          return;
        }

        try {
          const response = await fetch(`${API_URL}/products/${productId}`);
          const result = await response.json();

          if (result.success && result.data) {
            currentProduct = result.data;
            displayProduct(result.data);
            checkWishlistStatus();
          } else {
            showToast("Product not found");
            setTimeout(() => {
              window.location.href = "shop-3-column.html";
            }, 2000);
          }
        } catch (error) {
          console.error("Error loading product:", error);
          showToast("Error loading product");
        }
      }

      function displayProduct(product) {
        // Title and basic info
        document.getElementById("productTitle").textContent =
          product.title || "Unnamed Product";
        document.getElementById("productCategory").textContent =
          product.category || "Uncategorized";
        document.getElementById("productDescription").textContent =
          product.description || "No description available";
        document.getElementById("fullDescription").textContent =
          product.description || "No description available";

        // Price
        const priceElement = document.getElementById("productPrice");
        if (product.discounted_price) {
          priceElement.innerHTML = `
                    <span class="current-price">₹${product.discounted_price.toLocaleString(
                      "en-IN"
                    )}</span>
                    ${
                      product.original_price
                        ? `<span class="original-price">₹${product.original_price.toLocaleString(
                            "en-IN"
                          )}</span>`
                        : ""
                    }
                `;
        } else if (product.original_price) {
          priceElement.innerHTML = `<span class="current-price">₹${product.original_price.toLocaleString(
            "en-IN"
          )}</span>`;
        } else {
          priceElement.innerHTML = `<span class="current-price">Price on Request</span>`;
        }

        // Images
        const mainImage = document.getElementById("mainImage");
        const thumbnailContainer = document.getElementById("thumbnailImages");

        if (product.images && product.images.length > 0) {
          mainImage.src = product.images[0];

          thumbnailContainer.innerHTML = "";
          product.images.forEach((img, index) => {
            const thumb = document.createElement("img");
            thumb.src = img;
            thumb.className = index === 0 ? "active" : "";
            thumb.onclick = () => changeMainImage(img, thumb);
            thumbnailContainer.appendChild(thumb);
          });
        }

        // Materials
        if (product.material_used && product.material_used.length > 0) {
          document.getElementById("materialsSection").style.display = "block";
          const materialsList = document.getElementById("materialsList");
          materialsList.innerHTML = product.material_used
            .map((material) => `<span class="material-tag">${material}</span>`)
            .join("");
        }

        // Colors
        if (product.color_and_texture && product.color_and_texture.length > 0) {
          document.getElementById("colorSection").style.display = "block";
          const colorOptions = document.getElementById("colorOptions");
          colorOptions.innerHTML = product.color_and_texture
            .map(
              (color, index) =>
                `<div class="color-option ${
                  index === 0 ? "selected" : ""
                }" onclick="selectColor('${color}', this)">${color}</div>`
            )
            .join("");
          selectedColor = product.color_and_texture[0];
        }

        // How to Use
        if (product.how_to_use) {
          const howToUseContent = document.getElementById("howToUseContent");
          let content = "";
          if (product.how_to_use.title) {
            content += `<h5>${product.how_to_use.title}</h5>`;
          }
          if (
            product.how_to_use.points &&
            product.how_to_use.points.length > 0
          ) {
            content += "<ul>";
            product.how_to_use.points.forEach((point) => {
              content += `<li>${point}</li>`;
            });
            content += "</ul>";
          }
          howToUseContent.innerHTML = content || "No information available";
        }

        // FAQs
        if (product.faqs && product.faqs.length > 0) {
          const faqsContent = document.getElementById("faqsContent");
          faqsContent.innerHTML = product.faqs
            .map(
              (faq) => `
                    <div class="faq-item">
                        <div class="faq-question">${faq.question}</div>
                        <div class="faq-answer">${faq.answer}</div>
                    </div>
                `
            )
            .join("");
        }
      }

      function changeMainImage(src, thumbElement) {
        document.getElementById("mainImage").src = src;
        document.querySelectorAll(".thumbnail-images img").forEach((img) => {
          img.classList.remove("active");
        });
        thumbElement.classList.add("active");
      }

      function selectColor(color, element) {
        selectedColor = color;
        document.querySelectorAll(".color-option").forEach((opt) => {
          opt.classList.remove("selected");
        });
        element.classList.add("selected");
      }

      function increaseQuantity() {
        const input = document.getElementById("quantity");
        if (input.value < 10) {
          input.value = parseInt(input.value) + 1;
        }
      }

      function decreaseQuantity() {
        const input = document.getElementById("quantity");
        if (input.value > 1) {
          input.value = parseInt(input.value) - 1;
        }
      }

      function addToCart() {
        if (!currentProduct) return;

        const quantity = parseInt(document.getElementById("quantity").value);
        const cart = JSON.parse(localStorage.getItem("furnish_cart") || "[]");

        const existingIndex = cart.findIndex(
          (item) =>
            item.product_id === currentProduct._id &&
            item.selected_color_texture === selectedColor
        );

        if (existingIndex > -1) {
          cart[existingIndex].quantity += quantity;
        } else {
          cart.push({
            product_id: currentProduct._id,
            title: currentProduct.title,
            selected_color_texture: selectedColor,
            quantity: quantity,
            price_at_time:
              currentProduct.discounted_price || currentProduct.original_price,
            thumbnail_image:
              currentProduct.images && currentProduct.images[0]
                ? currentProduct.images[0]
                : null,
          });
        }

        localStorage.setItem("furnish_cart", JSON.stringify(cart));
        updateCartCount();
        showToast("Product added to cart!");
      }

      function toggleWishlist() {
        if (!currentProduct) return;

        const wishlist = JSON.parse(
          localStorage.getItem("furnish_wishlist") || "[]"
        );
        const index = wishlist.findIndex(
          (item) => item.product_id === currentProduct._id
        );

        if (index > -1) {
          wishlist.splice(index, 1);
          document.getElementById("wishlistBtn").classList.remove("active");
          document.getElementById("wishlistText").textContent =
            "Add to Wishlist";
          showToast("Removed from wishlist");
        } else {
          wishlist.push({
            product_id: currentProduct._id,
            title: currentProduct.title,
            price:
              currentProduct.discounted_price || currentProduct.original_price,
            thumbnail_image:
              currentProduct.images && currentProduct.images[0]
                ? currentProduct.images[0]
                : null,
          });
          document.getElementById("wishlistBtn").classList.add("active");
          document.getElementById("wishlistText").textContent = "In Wishlist";
          showToast("Added to wishlist!");
        }

        localStorage.setItem("furnish_wishlist", JSON.stringify(wishlist));
        updateWishlistCount();
      }

      function checkWishlistStatus() {
        const wishlist = JSON.parse(
          localStorage.getItem("furnish_wishlist") || "[]"
        );
        const inWishlist = wishlist.some(
          (item) => item.product_id === currentProduct._id
        );

        if (inWishlist) {
          document.getElementById("wishlistBtn").classList.add("active");
          document.getElementById("wishlistText").textContent = "In Wishlist";
        }
      }

      function sendEnquiry() {
        if (!currentProduct) return;

        // Add current product to cart and go to cart page
        addToCart();
        window.location.href = "cart.html?action=enquiry";
      }

      function updateCartCount() {
        const cart = JSON.parse(localStorage.getItem("furnish_cart") || "[]");
        const count = cart.reduce((total, item) => total + item.quantity, 0);
        document.getElementById("cartCount").textContent = count;
      }

      function updateWishlistCount() {
        const wishlist = JSON.parse(
          localStorage.getItem("furnish_wishlist") || "[]"
        );
        document.getElementById("wishlistCount").textContent = wishlist.length;
      }

      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.style.display = "block";
        setTimeout(() => {
          toast.style.display = "none";
        }, 3000);
      }
    </script>
  </body>
</html>
